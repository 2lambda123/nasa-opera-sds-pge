RunConfig:
    Name: OPERA-DISP-S1-PGE-TEST-CONFIG

    Groups:

        PGE:
            PGENameGroup:
                PGEName: DISP_S1_PGE

            InputFilesGroup:
                InputFilePaths:
                    - disp_s1_pge_test/input_dir

            DynamicAncillaryFilesGroup:
                AncillaryFileMap:
                    dem_file: disp_s1_pge_test/input_dir/dem_4326.tiff

            ProductPathGroup:
                OutputProductPath: disp_s1_pge_test/output_dir
                ScratchPath: disp_s1_pge_test/scratch_dir

            PrimaryExecutable:
                ProductIdentifier: DISP_S1
                ProgramPath: /bin/echo
                ProgramOptions:
                    - 'hello world > disp_s1_pge_test/output_dir/disp_s1_test.txt;'
                    - '/bin/echo DISP-S1 invoked with RunConfig'
                ErrorCodeBase: 500000
                SchemaPath: pge/disp_s1/schema/disp_s1_sas_schema.yaml
                AlgorithmParametersSchemaPath: pge/disp_s1/schema/algor_param_disp_s1_schema.yaml
                IsoTemplatePath:

            QAExecutable:
                Enabled: False
                ProgramPath:
                ProgramOptions: []

            DebugLevelGroup:
                DebugSwitch: False
                ExecuteViaShell: True  # Must be set to True for test to work

        SAS:
            runconfig:
                name: disp_s1_workflow_default

                groups:
                    pge_name_group:
                        pge_name: DISP_S1_PGE

                    input_file_group:
                        # List of paths to CSLC files.
                        cslc_file_list:
                            - /home/mamba/opera/test/data/test_disp_input/compressed_slc_t087_185678_iw2_20180101_20180210.h5

                        # Frame ID of the bursts contained in `cslc_file_list`.
                        frame_id: 123

                    dynamic_ancillary_file_group:
                        # Path to file containing SAS algorithm parameters.
                        algorithm_parameters_file: test/data/test_disp_s1_algorithm_parameters.yaml

                        # Paths to existing Amplitude Dispersion files (1 per burst) for PS update calculation. If
                        # none provided, computed using the input SLC stack.
                        amplitude_dispersion_files:
                            - /home/mamba/opera/test/data/test_disp_input/t087_185678_iw2_amp_dispersion.tif

                    primary_executable:
                        # Product type of the PGE.
                        product_type: DISP_S1_SINGLE

                    product_path_group:
                        # Directory where PGE will place results.
                        product_path: output

                        # Path to the scratch directory.
                        scratch_path: scratch

                        # Path to the SAS output directory.
                        sas_output_path: output

                        # Version of the product, in ‘<major>.<minor>’ format.
                        product_version: '0.1'

                        # Whether the SAS should output and save the Compressed SLCs in addition to the standard
                        # product output.
                        save_compressed_slc: true

                    worker_settings:
                        # Whether to use GPU for processing (if available).
                        gpu_enabled: true

                        # (For non-GPU) Number of cpu cores to use for Python multiprocessing. Uses
                        # `multiprocessing.cpu_count()` if not set.
                        n_workers: 32

                        # Number of threads to use per worker. This sets the OMP_NUM_THREADS environment variable in
                        #   each python process.
                        threads_per_worker: 2

                        # Size (in GB) of blocks of data to load at a time.
                        block_size_gb: 1.0

                    # Path to the output log file in addition to logging to stderr.
                    log_file: output/pge_logfile.log

